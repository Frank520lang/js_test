<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../js/xlsx.core.min.js"></script> 
    <script src="../js/xlsx.utils.js"></script>
</head>
<body>
    <input type="file" id="file"  onchange="getData()">
    <script>
        //返回值是一个对象
        var file = document.getElementById("file");
        console.log(file);
        //
        file.onchange = function(){
            //获取到读取到的文件
            var readFile = this.files[0];
            xlsxUtils.import(readFile,(c)=>{
                // var show1 =xlsxUtils.getSheetByIndex(0)[0].name;
                // var show2 =xlsxUtils.getSheetByIndex(0)[1].sex;
                // console.log(show1);
                // console.log(show2);
                var data = xlsxUtils.getSheetByIndex(0);
                var name=[];
                var sex=[];
                for(var i=0;i<data.length;i++){
                    //console.log(data[i]);
                    name.push(data[i].name);
                    sex.push(data[i].sex);

                    //name[i]=data[i].name;
                    //sex[i]=data[i].sex;
                }
                console.log("---------------------------------------");
                for(var j=0;j<name.length;j++){
                    console.log(name[j]);
                }
                console.log("---------------------------------------");
                for(var k=0;k<name.length;k++){
                    console.log(sex[k]);
                }

            });
            
        }
           
            
        // function getData(){
        //     console.log("运行到这里");
        //     console.log(this);

        //      //获取到读取到的文件
        //     var readFile = this.files[0];
        //     xlsxUtils.import(readFile,(c)=>{
        //         // var show1 =xlsxUtils.getSheetByIndex(0)[0].name;
        //         // var show2 =xlsxUtils.getSheetByIndex(0)[1].sex;
        //         // console.log(show1);
        //         // console.log(show2);
        //         var data = xlsxUtils.getSheetByIndex(0);
        //         var name=[];
        //         var sex=[];
        //         for(var i=0;i<data.length;i++){
        //             //console.log(data[i]);
        //             name.push(data[i].name);
        //             sex.push(data[i].sex);

        //             //name[i]=data[i].name;
        //             //sex[i]=data[i].sex;
        //         }
        //         console.log("---------------------------------------");
        //         for(var j=0;j<name.length;j++){
        //             console.log(name[j]);
        //         }
        //         console.log("---------------------------------------");
        //         for(var k=0;k<name.length;k++){
        //             console.log(sex[k]);
        //         }

        //     });
        // }
    </script>
</body>
</html>